秒杀步骤:
    0)限流
    1)校验库存(redis)
    2)发送kafka
    3)扣库存(乐观锁、悲观锁)
    4)创建订单
    5)支付

每当一个请求通过了限流, 到达了Service, 通过了库存校验之后, 就将任务信息发给Kafka, 这样一个请求就可以直接返回了。
消费程序再对数据进行入库落地。因为异步了, 所以最终需要采取回调或者是其他提醒的方式提醒用户购买完成。

限流策略:
    1)IP限流(在负载均衡处, 防止恶意重复流量)
    2)单机流量限流(guava), 保护服务(hystrix)
    3)用户uid限流(redis)
    4)结合redis做好快速失败方案。(例如:活动结束、库存为0)

先扣库存再做业务逻辑。
页面静态化。前端按钮置灰。
请求分段放行。(防机器人和脚本)

